#include <string>
#include <ctime>
#include <stdlib.h>//atoi
#include <iostream>
#include <vector>
#include <fstream>
#include "signal.h"//Ctrl+C catch
#include "BigIntegerLibrary.hh"//computing large numbers

using namespace std;

#include <openssl/md5.h>
#include <openssl/md4.h>
#include <openssl/rc4.h>
#include "fast_md4.h"
#include "fast_md5.h"

typedef unsigned char uint8_t;
typedef unsigned int uint32_t;
typedef unsigned short uint16_t;

size_t getHash(char szHash[], unsigned char hash[])
{
       unsigned int number;
       size_t nHashLen;

       if(((nHashLen = strlen(szHash)) % 2) != 0)
            return(0);

       for(size_t i = 0;i < nHashLen;i++) {
           if(isxdigit(szHash[i]) == 0)
              return(0);
       }

       nHashLen /= 2;

       for(size_t i = 0;i < nHashLen;i++) {
           sscanf(&szHash[i*2],"%2x",&number);
           hash[i] = (unsigned char)number;
       }
       return(nHashLen);
}

void dump(uint8_t *digest)
{
     for(int i = 0;i < 16;i++)
			printf("%02X",digest[i]);
}

char candidate[11];

void wrapUp(int sig)
{
	cout << "\naborting...\n";
	cout << "ended on " << candidate << "\n";
	exit(0);
}

#include "hba_L5_alnum.h"
#include "hba_L6_alnum.h"
#include "hba_L7_alnum.h"
#include "hba_L8_alnum.h"
#include "hba_L9_alnum.h"
#include "hba_L10_alnum.h"

#include "hba_L5_mixalnum.h"
#include "hba_L6_mixalnum.h"
#include "hba_L7_mixalnum.h"
#include "hba_L8_mixalnum.h"
#include "hba_L9_mixalnum.h"
#include "hba_L10_mixalnum.h"

#include "hba_L5_mixalnumsymb14.h"
#include "hba_L6_mixalnumsymb14.h"
#include "hba_L7_mixalnumsymb14.h"
#include "hba_L8_mixalnumsymb14.h"
#include "hba_L9_mixalnumsymb14.h"
#include "hba_L10_mixalnumsymb14.h"

#include "hba_L5_mixalnumsymb32.h"
#include "hba_L6_mixalnumsymb32.h"
#include "hba_L7_mixalnumsymb32.h"
#include "hba_L8_mixalnumsymb32.h"
#include "hba_L9_mixalnumsymb32.h"
#include "hba_L10_mixalnumsymb32.h"

void usage()
{
       cout << " Usage: <start word> <permutations> <crack mode> <hash file> <year packets were recovered>\n";
	   cout << "\n         crack modes:\n";
       cout << "         1 = brute force attack with (a-z, 0-9)\n";
       cout << "         2 = brute force attack with (a-z, A-Z, 0-9)\n";
       cout << "         3 = brute force attack with (a-z, A-Z, 0-9, 14 special chars)\n";
       cout << "         4 = brute force attack with (a-z, A-Z, 0-9, 32 special chars)\n";
       cout << "\n See README.txt for more details\n\n";
	   exit(1);
}

int main (int argc, char *argv[])
{
	cout << "\nHavokv3 kerb5 multihash - a distributed kerberos 5 preauth password cracker\n";
	cout << "multiple hashes support - support for up to 25 simultaneous hashes\n";
    cout << "                  - by Nathanael Warren, 2009\n\n";

	if(argc!=6)
		usage();

	// so we can show stats on ctrl+c
	signal(SIGINT, wrapUp);

	for(unsigned int i=0;i<strlen(argv[1]);i++)//store argv[1] in candidate array
		candidate[i]=argv[1][i];

	unsigned int crackmode = atoi(argv[3]);
	unsigned int pass_len = strlen(argv[1]);

	uint8_t ts_checksum_array[25][16]={{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
		{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F },
	{ 0xA6, 0x04, 0x67, 0x77, 0xA8, 0xE0, 0x5F, 0x53, 0x7F, 0x4C, 0xA1, 0x47, 0x9C, 0x26, 0x73, 0x3F }};

	uint8_t enc_data_array[25][36]={{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
		{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 },
	{ 0x2A, 0x97, 0x85, 0xBF, 0x50, 0x36, 0xC4, 0x5D, 0x38, 0x43, 0x49, 0x0B, 0xF9, 0xC2, 0x28, 0xE8, 0xC1, 0x86, 0x53, 0xE1, 0x0C, 0xE5, 0x8D, 0x7F, 0x8E, 0xF1, 0x19, 0xD2, 0xEF, 0x4F, 0x92, 0xB1, 0x80, 0x3B, 0x14, 0x51 }};

	//open the hash list...
	ifstream hash_list(argv[4]);
	
	//check to ensure hash list opened correctly
	if(!hash_list.is_open())
	{
		cout<<"Error opening file \'"<<argv[4]<<"\'\n";
		exit(1);
	}

	char shash[105];//temporary array to store hash strings in

	int numhashes=0;
	while(!hash_list.eof())
	{
		//checksum of timestamp buffer
		uint8_t ts_checksum[16];
		//encrypted timestamp buffer
		uint8_t enc_data[36];

		char schecksum[]="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX";
		char sencdata[]="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX";

		hash_list.getline(shash,105);//get each line of hash file

		if(numhashes==25)//make sure that no more than 25 hashes are loaded
		{
			cout << "more than 25 hashes not supported as of this release!\n";
			exit(1);
		}

		if(strlen(shash)!=104)//make sure timestamps meet requirements
		{
			cout << "encrypted timestamp is a 104-character hex string\n";
			exit(1);
		}

		//chop timestamp string into two different strings...
		for(int i=0;i<32;i++)
			schecksum[i]=shash[i];//the timestamp checksum
		for(int i=0;i<72;i++)
			sencdata[i]=shash[i+32];//and the encrypted timestamp

		//convert strings to binary...
		getHash(schecksum,ts_checksum);

		//and store them in their arrays
		for(int i=0;i<16;i++)
			ts_checksum_array[numhashes][i]=ts_checksum[i];

		getHash(sencdata,enc_data);

		for(int i=0;i<36;i++)
			enc_data_array[numhashes][i]=enc_data[i];

		numhashes++;//count loops
	}

	cout << numhashes << " encrypted timestamps loaded.\n";

	hash_list.close();//close hash list

	cout << " computing (this may take a while)...\n\n";

	switch(pass_len)
	{
	case 5:
		switch(crackmode)
		{
		case 1:
			hba_L5_alnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 2:
			hba_L5_mixalnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 3:
			hba_L5_mixalnumsymb14(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 4:
			hba_L5_mixalnumsymb32(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		default:
			usage();
		}
	case 6:
		switch(crackmode)
		{
		case 1:
			hba_L6_alnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 2:
			hba_L6_mixalnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 3:
			hba_L6_mixalnumsymb14(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 4:
			hba_L6_mixalnumsymb32(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		default:
			usage();
		}
	case 7:
		switch(crackmode)
		{
		case 1:
			hba_L7_alnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 2:
			hba_L7_mixalnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 3:
			hba_L7_mixalnumsymb14(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 4:
			hba_L7_mixalnumsymb32(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		default:
			usage();
		}
	case 8:
		switch(crackmode)
		{
		case 1:
			hba_L8_alnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 2:
			hba_L8_mixalnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 3:
			hba_L8_mixalnumsymb14(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 4:
			hba_L8_mixalnumsymb32(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		default:
			usage();
		}
	case 9:
		switch(crackmode)
		{
		case 1:
			hba_L9_alnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 2:
			hba_L9_mixalnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 3:
			hba_L9_mixalnumsymb14(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 4:
			hba_L9_mixalnumsymb32(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		default:
			usage();
		}
	case 10:
		switch(crackmode)
		{
		case 1:
			hba_L10_alnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 2:
			hba_L10_mixalnum(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 3:
			hba_L10_mixalnumsymb14(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		case 4:
			hba_L10_mixalnumsymb32(candidate,argv[2],ts_checksum_array,enc_data_array,numhashes,argv[5]);
			exit(0);
		default:
			usage();
		}
	default:
		usage();
	}
return 0;
}
